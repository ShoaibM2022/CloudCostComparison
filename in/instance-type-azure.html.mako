<!DOCTYPE html>

<html lang="en">
  <head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TBZCV32');</script>
    <!-- End Google Tag Manager -->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="/default.css" media="screen">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" type="image/png" href="https://assets.vantage.sh/www/favicon-32x32.png">
    <title>${i["Azure"][2]["value"]} pricing and specs - Vantage</title>
    <meta name="description" content="${description}">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  </head>
    
  <body>
    <div class="main">
      <div class="nav">
        <div class="logo-group">
          <a href="/azure/" class="logo">
            <img width="135" height="100%" src="/vantage-logo-horizontal.svg">
          </a>
          <a href="https://github.com/vantage-sh/ec2instances.info" class="btn btn-github btn-icon contr-mobile">
            <svg class="me-1" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" fill="#1a1a1c" d="M9 0C4.0275 0 0 4.0275 0 9C0 12.9825 2.57625 16.3463 6.15375 17.5387C6.60375 17.6175 6.7725 17.3475 6.7725 17.1112C6.7725 16.8975 6.76125 16.1888 6.76125 15.435C4.5 15.8513 3.915 14.8837 3.735 14.3775C3.63375 14.1187 3.195 13.32 2.8125 13.1062C2.4975 12.9375 2.0475 12.5212 2.80125 12.51C3.51 12.4987 4.01625 13.1625 4.185 13.4325C4.995 14.7937 6.28875 14.4113 6.80625 14.175C6.885 13.59 7.12125 13.1962 7.38 12.9712C5.3775 12.7463 3.285 11.97 3.285 8.5275C3.285 7.54875 3.63375 6.73875 4.2075 6.10875C4.1175 5.88375 3.8025 4.96125 4.2975 3.72375C4.2975 3.72375 5.05125 3.4875 6.7725 4.64625C7.4925 4.44375 8.2575 4.3425 9.0225 4.3425C9.7875 4.3425 10.5525 4.44375 11.2725 4.64625C12.9938 3.47625 13.7475 3.72375 13.7475 3.72375C14.2425 4.96125 13.9275 5.88375 13.8375 6.10875C14.4113 6.73875 14.76 7.5375 14.76 8.5275C14.76 11.9812 12.6562 12.7463 10.6538 12.9712C10.98 13.2525 11.2613 13.7925 11.2613 14.6363C11.2613 15.84 11.25 16.8075 11.25 17.1112C11.25 17.3475 11.4187 17.6287 11.8688 17.5387C15.4237 16.3463 18 12.9712 18 9C18 4.0275 13.9725 0 9 0Z" fill="white"/>
            </svg>
            Star
          </a>
        </div>
        <a href="https://www.vantage.sh/blog/vantage-launches-azure-cost-recommendations" class="vantage d-none d-xl-block">Vantage launches <span class="fw-semibold">Azure Cost Recommendations -></span></a>
        <div class="nav-buttons">
          <a target="_blank" href="https://join.slack.com/t/vantagecommunity/shared_invite/zt-oey52myv-gq4AWRKkX25kjp1UGziPTw" class="btn btn-purple btn-icon">
            <img class="me-1" width="18px" height="18px" src="https://cdn.bfldr.com/5H442O3W/at/pl546j-7le8zk-j7mis/Slack_Mark_Monochrome_White.svg?auto=webp&format=png&width=100&height=100"> 
            Slack
          </a>
          <div class="px-1"></div>
          <a href="https://github.com/vantage-sh/ec2instances.info" class="btn btn-github btn-icon">
            <svg class="me-1" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" fill="#1a1a1c" d="M9 0C4.0275 0 0 4.0275 0 9C0 12.9825 2.57625 16.3463 6.15375 17.5387C6.60375 17.6175 6.7725 17.3475 6.7725 17.1112C6.7725 16.8975 6.76125 16.1888 6.76125 15.435C4.5 15.8513 3.915 14.8837 3.735 14.3775C3.63375 14.1187 3.195 13.32 2.8125 13.1062C2.4975 12.9375 2.0475 12.5212 2.80125 12.51C3.51 12.4987 4.01625 13.1625 4.185 13.4325C4.995 14.7937 6.28875 14.4113 6.80625 14.175C6.885 13.59 7.12125 13.1962 7.38 12.9712C5.3775 12.7463 3.285 11.97 3.285 8.5275C3.285 7.54875 3.63375 6.73875 4.2075 6.10875C4.1175 5.88375 3.8025 4.96125 4.2975 3.72375C4.2975 3.72375 5.05125 3.4875 6.7725 4.64625C7.4925 4.44375 8.2575 4.3425 9.0225 4.3425C9.7875 4.3425 10.5525 4.44375 11.2725 4.64625C12.9938 3.47625 13.7475 3.72375 13.7475 3.72375C14.2425 4.96125 13.9275 5.88375 13.8375 6.10875C14.4113 6.73875 14.76 7.5375 14.76 8.5275C14.76 11.9812 12.6562 12.7463 10.6538 12.9712C10.98 13.2525 11.2613 13.7925 11.2613 14.6363C11.2613 15.84 11.25 16.8075 11.25 17.1112C11.25 17.3475 11.4187 17.6287 11.8688 17.5387C15.4237 16.3463 18 12.9712 18 9C18 4.0275 13.9725 0 9 0Z" fill="white"/>
            </svg>
            Star
          </a>
        </div>
      </div>
      <div class="columns">
        <div class="column-left--parent">
          <div class="column-left">
            <h1 class="h3 mb-0 fw-bolder">${i["Azure"][2]["value"]}</h1>
            
            <!-- Description -->
            <p class="pt-md-4 py-3 mb-2 small lh-base">${description}</p>

            <div class="d-flex align-items-center mb-3">
              <span class="material-icons me-1">paid</span>
              <p class="h6 fw-semibold mb-0">Pricing</p>
            </div>
            <!-- Prices -->
            <div class="small d-flex flex-row flex-wrap pe-2 mb-4">
              <div class="col-md-3 col-6 mb-md-0 mb-3">
                <p class="h6 mb-0 fw-semibold" id="p_od"></p>
                <p class="mb-0 fs-12 text-muted">On Demand</p>
              </div>
              <div class="col-md-3 col-6 mb-md-0 mb-3">
                <p class="h6 mb-0 fw-semibold" id="p_spot"></p>
                <p class="mb-0 fs-12 text-muted">Spot</p>
              </div>
              <div class="col-md-3 col-6">
                <p class="h6 mb-0 fw-semibold" id="p_1yr"></p>
                <p class="mb-0 fs-12 text-muted">1 Yr Reserved</p>
              </div>
              <div class="col-md-3 col-6">
                <p class="h6 mb-0 fw-semibold" id="p_3yr"></p>
                <p class="mb-0 fs-12 text-muted">3 Yr Reserved</p>
              </div>
            </div>

            <!-- price Selects -->
            <div class="d-flex flex-wrap mt-2">
              <div class="col-6 pe-2 mb-2">
                <select class="form-select form-select-sm" id="region">
                  <!-- TODO: Localize default option order -->
                  % for r in regions:
                  <option value='${r[0]}'>${r[1]}</option>
                  % endfor
                </select>
              </div>
              <div class="col-6 mb-2">
                <select class="form-select form-select-sm" id="os">
                  <option value="linux">Linux</option>
                  <option value="windows">Windows</option>
                </select>
              </div>
              <div class="col-6 pe-2">
                <select class="form-select form-select-sm" id="unit">
                  <option value="second">Per Second</option>
                  <option value="minute">Per Minute</option>
                  <option value="hour" selected="selected">Per Hour</option>
                  <option value="day">Per Day</option>
                  <option value="week">Per Week</option>
                  <option value="month">Per Month</option>
                  <option value="year">Per Year</option>
                </select>
              </div>
              <div class="col-6">
                <select class="form-select form-select-sm" id="term">
                  <option value="Standard.allUpfront">Reservation</option>
                  <option value="Standard.hybridbenefit">Reservation (Hybrid Benefit)</option>
                  <option value="Standard.subscription">Subscription</option>
                  <option value="Savings.allUpfront">Savings Plan</option>
                  <option value="Savings.hybridbenefit">Savings Plan (Hybrid Benefit)</option>
                  <option value="Savings.subscription">Savings Plan with Subscription<option>
                </select>
              </div>
            </div>

            <!-- Instance families -->
            <div class="mt-4 d-flex flex-column">
              <div class="d-flex align-items-center mb-3">
                <span class="material-icons me-1">dns</span>
                <p class="h6 fw-semibold mb-0">Family Sizes</p>
              </div>
              <table class="table table-mono mb-0">
                <thead>
                  <tr>
                    <th>Size</th>
                    <th class="text-center">vCPUs</th>
                    <th class="text-center">Memory (GiB)</th>
                  </tr>
                </thead>
                <tbody>
                  % for f in family:
                    % if f["name"] == i["Azure"][1]['value']:
                    <tr class="no-link">
                      <td>${f["name"]}</td>
                    % else:
                    <tr>
                      <td><a href="/azure/vm/${f["name"]}">${f["name"]}</a></td>
                    % endif
                    <td class="text-center">${f["cpus"]}</td>
                    <td class="text-center">${f["memory"]}</td>
                  </tr>
                  % endfor
                </tbody>
              </table>
            </div>

            <p class="py-md-2 small lh-base"><a href="/azure/" class="text-decoration-none"><- All Azure VM Types</a></p>

            <!-- Instance variants -->
            % if len(variants) > 1:
            <div class="mt-4 d-flex flex-column">
              <div class="d-flex align-items-center mb-3">
                <span class="material-icons me-1">dns</span>
                <p class="h6 fw-semibold mb-0">Instance Variants</p>
              </div>
              <table class="table table-mono">
                <thead>
                  <tr>
                    <th>Variant</th>
                  </tr>
                </thead>
                <tbody>
                  % for v in variants:
                    % if v[0] == i["Azure"][1]['value']:
                      <tr class="no-link">
                        <td>${v[0]}</td>
                    % else:
                      <tr>
                        <td><a href="/azure/vm/${v[1]}">${v[0]}</a></td>
                    % endif
                    </tr>
                  % endfor
                </tbody>
              </table>
            </div>
            % endif
          </div>

          <div class="column-middle mb-5">
            <div class="w-100 d-flex flex-column flex-fill pb-5">          
              <div class="d-flex align-items-center mb-3">
                <span class="material-icons me-1">info</span>
                <p class="h6 fw-semibold mb-0">Instance Details</p>
              </div>
              % for category, attrs in i.items():
                % if category == "Coming Soon":
                  % for a in attrs:
                    <!--<p>${a["display_name"]}</p>-->
                  % endfor
                % elif category == "Not Shown":
                <!--
                  <p>Request this data to be included on Github</p>
                  % for a in attrs:
                    <p>${a["cloud_key"]}</p>
                  % endfor
                -->
                % elif category == "Pricing":
                  <p></p>
                % else:
                  % if category == "Networking":
                    <div class="vantage-callout">
                      <div class="callout-close">
                        <span class="material-icons">close</span>
                      </div>
                      <img width="auto" height="25" src="/vantage-logo_full.svg">
                      <h5>Concerned about cloud costs?</h5>
                      <p>Connect your Azure account in under<br />5 minutes to see savings.</p>
                      <a href="https://console.vantage.sh/signup" target="_blank">Connect Azure Account</a>
                    </div>
                  % endif
                  <table class="table" id="${category}">
                    <tr>
                      <th class="col-6 border-end"><a href="#${category}">${category}</a></th>
                      <th class="col-6">Value</th>
                    </tr>
                  % for a in attrs:
                    <tr>
                      <td class="col-6 border-end">${a["display_name"]}</td>
                      <td class="col-6"><span class="${a["style"]}">${a["value"]}</span></td>
                    </tr>
                  % endfor
                  </table>
                % endif
              % endfor
              % if len(unavailable) > 0 and false:
                <table class="table" id="Unavailable">
                  <tr>
                    <th class="col-4 border-end">Unavailable</th>
                    <th class="col-4 border-end">Unsupported Region</th>
                    <th class="col-4">Unsupported OS</th>
                  </tr>
                  % for u in unavailable:
                  <tr>
                    <td class="col-4 border-end">${u[0]}</td>
                    <td class="col-4 border-end">${u[1]}</td>
                    <td class="col-4">${u[2]}</td>
                  </tr>
                  % endfor
                </table>
              % endif
            </div>
          </div>
        </div>
        <div class="column-right">
          <div class="sidebar-section links">
            See a data problem? <a href="https://github.com/vantage-sh/ec2instances.info/issues/new" target="_blank" class="text-decoration-none">Open a ticket.</a>
          </div>
          <div class="sidebar-section ticket small">
            <form name="submit-to-google-sheet">
              <label class="mb-3" for="textarea">What's missing from this page?</label><br>
              <input type="hidden" name="page" value="${i["Azure"][2]['value']}">
              <textarea class="mb-4 feedback-text" name="feedback" id="textarea" placeholder="Your feedback"></textarea><br>
              <label class="mb-3" for="submit-email">Email (optional, if we have questions):</label><br>
              <input name="email" id="submit-email" type="email" class="submit-email mb-4">
              <button id="submit-feedback" class="btn btn-purple" type="submit">Send</button>
            </form>
            <p id="submission-response"></p>
            <span>Supported by <a target="_blank" href="https://vantage.sh/" class="text-decoration-none">Vantage</a></span>
          </div>
        </div>
      </div>
    </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
  <script src="/store/store.js" type="text/javascript" charset="utf-8"></script>
  <script src="/vantage.js" type="text/javascript" charset="utf-8"></script>
  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzf3nm7AMdE5JRgU_-R_VFNdekkzhN1-RjiQDeqZu3UsojLH6Kdvo5G0pyC0UzJJKo4/exec'
    const form = document.forms['submit-to-google-sheet']

    form.addEventListener('submit', e => {
      e.preventDefault();
      $("#submit-feedback").attr("disabled", true);
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => {
          $("#submission-response").html("Feedback received!"); 
          $("#submit-feedback").attr("disabled", false); 
        })
        .catch(error => $("#submission-response").html("Something went wrong, contact support@vantage.sh"));
    })
  </script>
  <script type="text/javascript">
  $(function() {
    vantage_settings();

    initialize_prices();
    disable_regions();

    $('#region').change(function() {
      recalulate_redisplay_prices()
    });
    $('#os').change(function() {
      recalulate_redisplay_prices()
    });
    $('#unit').change(function() {
      recalulate_redisplay_prices()
    });
    $('#term').change(function() {
      recalulate_redisplay_prices()
    });


    function format_price(element, price_value) {
      // Handle prices from $0.0001 to $100,000
      if (isNaN(price_value)) {
        $('#' + element).html('N/A');
      } else if (price_value === "N/A") {
        $('#' + element).html('N/A');
      } else if (price_value < .99) {
        $('#' + element).html("&dollar;" + price_value.toFixed(4));
      } else if (price_value > 99 && price_value <= 9999) {
        $('#' + element).html("&dollar;" + price_value.toFixed(2));
      } else if (price_value > 9999) {
        // TODO: localize, use periods instead of commas in EU for example
        $('#' + element).html("&dollar;" + Math.floor(price_value).toLocaleString('en-US'));
      } else {
        $('#' + element).html("&dollar;" + price_value.toFixed(3));
      }
    }

    function initialize_prices() {
      format_price("p_od", ${defaults[0]});
      format_price("p_spot", ${defaults[1]});
      format_price("p_1yr", ${defaults[2]});
      format_price("p_3yr", ${defaults[3]});
    };

    function disable_regions() {
      var regions = []
      var unavailable = ${unavailable};
      for (const u of unavailable) {
        if (u[2] == 'All') {
          regions.push(u[1]);
        }
      }

      $("#region option").each(function(i) {
        var dropdown_region = $(this).val();
        if (regions.includes(dropdown_region)) {
          $(this).attr("disabled", "disabled");
        }
      });

    };

    function recalulate_redisplay_prices() {
      var region = $('#region').val();
      var os = $('#os').val();
      var unit = $('#unit').val();
      var term = $('#term').val();
      var price = ${i["Pricing"]};
      var deny = ${unavailable};
      var displayed_prices = ['ondemand', '_1yr', 'spot', '_3yr'];
      var elements = ['p_od', 'p_1yr', 'p_spot', 'p_3yr'];

      // Check if this combination of price selections is available
      // Handle where only a specifc OS like Windows is not available in a region
      for (const d of deny) {
        if (d[1] === region) {
          if (d[3] === os || d[2] === 'All') {
            for (var i = 0; i < elements.length; i++) {
              format_price(elements[i], "N/A");
            }
            return;
          } 
        }
      }

      var hour_multipliers = {
        'second': 1 / (60 * 60),
        'minute': 1 / 60,
        'hour': 1,
        'day': 24,
        'week': 7 * 24,
        'month': 730,   // use convention of 730 hrs/month
        'year': 8760
      };


      for(var i =0; i < elements.length; i++) {
        var element = elements[i];
        var displayed_price = displayed_prices[i];
        
        var price_value = price[region][os][displayed_price];

        if (price_value == 'N/A') {
          $('#' + element).html('N/A');
        } else {

          // Handle the term conditions for reservations
          if (displayed_price === '_1yr' || displayed_price === '_3yr') {
            price_value = parseFloat(price_value[term]);
          }
          
          // Show by day, month, year etc
          price_value = parseFloat(price_value) * hour_multipliers[unit];
          
          format_price(element, price_value);
        }
      }
    }
  });
  </script>
  </body>
</html>